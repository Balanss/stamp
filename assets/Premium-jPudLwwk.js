import{r as a,j as e,w,v as y,x as C,y as x,U as N,a as U,Q as p,d as S,z as v,A as D,B as M}from"./index-4bnI98Gt.js";import{l as P,M as I}from"./Modal-8pKvsF1f.js";import{r as E}from"./right-AN99vaOx.js";function R({setStamps:n}){const r=i=>{const f=w(y(x,"PremiumDealStamps"));return C(f,l=>{const c=l.docs.sort(()=>.5-Math.random()).map(t=>({imageUrl:t.data().imageUrl,likes:t.data().likes,fromWho:t.data().From,stampId:t.id,discription:t.data().discription,price:t.data().price,title:t.data().name})).slice(0,i);n(c)})};return a.useEffect(()=>{const i=r(4);return()=>i()},[]),e.jsxs("section",{className:"flex items-center gap-10 justify-end",children:[e.jsx("button",{className:"bg-red-700 text-white font-bold py-2 px-4 rounded",onClick:()=>r(4),children:" More "}),e.jsx("img",{src:E,alt:"right",className:"w-[30px] h-[30px] cursor-pointer",onClick:()=>{n([]),r(4)}})]})}function W(){const[n,r]=a.useState([]),{currentUser:i,isUserPremium:f,UserCompanyName:b}=a.useContext(N),[l,o]=a.useState(!1),[c,t]=a.useState(null),k=async s=>{if(!U.currentUser){p.error("You must be signed in to like a stamp.");return}const m=S(x,"PremiumDealStamps",s);await v(x,async u=>{const j=await u.get(m);if(!j.exists())throw"Document does not exist!";const d=j.data();(d.likesCollection||[]).includes(i)?(u.update(m,{likes:d.likes-1,likesCollection:D(i)}),p.info("Unliked.")):(u.update(m,{likes:d.likes+1,likesCollection:M(i)}),p.info("Liked."))})},g=s=>{t(s),o(!0)};return e.jsxs("div",{className:"text-black mt-[120px] flex flex-col items-center",children:[e.jsx(R,{setStamps:r}),e.jsx("section",{className:"flex flex-row gap-10 items-center justify-center flex-wrap p-5",children:n.slice(0,8).map((s,h)=>e.jsxs("div",{className:"flex flex-col justify-between items-center  relative",children:[e.jsxs("div",{style:{position:"relative"},children:[e.jsx("img",{src:s.imageUrl,alt:"",className:"h-[400px] w-[300px] border-2 border-blue-black rounded-xl"}),e.jsx("span",{className:"bg-red-500 text-white font-bold p-2 cursor-pointer",style:{position:"absolute",top:0,left:0},onClick:()=>{g(s)},children:"  More info"})]}),e.jsxs("div",{className:"absolute bg-green-700 bottom-0 text-white w-full flex flex-row gap-10 justify-center items-center ",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsxs("p",{children:[" ",s.likes]}),e.jsx("img",{src:P,className:"w-6 h-6 cursor-pointer",onClick:()=>k(s.stampId)})]}),e.jsxs("p",{children:[" ",s.fromWho]}),e.jsxs("p",{children:[" ",s.price]}),e.jsx("h1",{children:s.title})]})]},h))}),e.jsx(I,{modalIsOpen:l,setModalIsOpen:o,currentStamp:c})]})}export{W as default};
